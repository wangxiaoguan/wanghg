<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <style>
        #app{
            width:500px;
            height:300px;
            border: 1px solid #66d3db;
            margin: 100px auto;
            
        }
    </style>
</head>
<body>
    <div contenteditable=true id='app' oninput="input()"></div>
</body>
<script>
    function getSelectionCoords() {
    let win =  window;
    var doc = win.document;
    console.log(doc)
    var sel = doc.selection, range, rects, rect;
    var x = 0, y = 0;
    if (sel) {
        if (sel.type != "Control") {
            range = sel.createRange();
            range.collapse(true);
            x = range.boundingLeft;
            y = range.boundingTop;
        }
    } else if (win.getSelection) {
        sel = win.getSelection();
        if (sel.rangeCount) {
            range = sel.getRangeAt(0).cloneRange();
            if (range.getClientRects) {
                range.collapse(true);
                rects = range.getClientRects();
                if (rects.length > 0) {
                    rect = rects[0];
                }
                // 光标在行首时，rect为undefined
                if(rect){
                    x = rect.left;
                    y = rect.top;
                }
            }
            // Fall back to inserting a temporary element
            if ((x == 0 && y == 0) || rect === undefined) {
                var span = doc.createElement("span");
                if (span.getClientRects) {
                    // Ensure span has dimensions and position by
                    // adding a zero-width space character
                    span.appendChild( doc.createTextNode("\u200b") );
                    range.insertNode(span);
                    rect = span.getClientRects()[0];
                    x = rect.left;
                    y = rect.top;
                    var spanParent = span.parentNode;
                    spanParent.removeChild(span);

                    // Glue any broken text nodes back together
                    spanParent.normalize();
                }
            }
        }
    }
    console.log(x,y) //获取光标的坐标
    return { x: x, y: y };
}
   function input(){
       console.log()
       let el =document.getElementById('app')
       getSelectionCoords(el)
   }
</script>
<script>
    // var app = 234 || 12312
    // console.log(app)
    // const start = new Date(new Date(new Date().toLocaleDateString()).getTime());
    // console.log(start); //Mon Dec 04 2017 00:00:00 GMT+0800 (中国标准时间)
    // var time = new Date(new Date().toLocaleDateString()).getTime()
    // console.log(time)

    // //多层嵌套对象数据JSON字符串化
    // function _deepClone(data) {
    //     var t = typeof data, o, i, ni;
    //     if (t === 'array') {
    //         o = [];
    //     } else if (t === 'object') {
    //         o = {};
    //     } else {
    //         return data;
    //     }
    
    //     if (t === 'array') {
    //         for (i = 0, ni = data.length; i < ni; i++) {
    //             o.push(Demo.api._deepClone(data[i]));
    //         }
    //         return o;
    //     } else if (t === 'object') {
    //         for (i in data) {
    //             o[i] =Demo.api._deepClone(data[i]);
    //         }
    //         return o;
    //     }
    // }
    // function addToChatTXT(chat){ 
    //     let msg = _deepClone(chat);
    //     let record = JSON.stringify(msg)
    //     window.localStorage.setItem('chatRcord', record);
    // }
    // var data ={
    //     a1:1,
    //     b2:{a:2},
    //     c3:'wang',
    //     d4:function(){
    //         console.log('1111')
    //     },
    //     e5:[1,2,3,4,5,6],
    //     f6:true,
    //     j7:undefined
    // }
    // var e = Object.assign({},data)
    // var keys = Object.keys(data);//获取所有属性的集合["a1", "b2", "c3", "d4", "e5", "f6"]
    // var length = Object.keys(data).length;
    // var result = data[Object.keys(data)[Object.keys(data).length - 1]]
    // console.log(keys)
    // console.log(length)
    // console.log(result)
    // console.log(e)
    //如果你想获取一个对象的所有属性,，甚至包括不可枚举的，请查看Object.getOwnPropertyNames。

    // var obj = {}
    // var result = Object.keys(obj)
    // console.log(result)
    </script>
</html>