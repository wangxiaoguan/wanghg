<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>
<body>
    <div id="box">
    </div>
</body>
<script>

    // var p  =  new Promise((resolve,reject)=>{
    //             resolve("好好学习")
    // })
    // console.log(p)
    // function async(){
    //     var p =new Promise((resolve,reject)=>{
    //         resolve("执行成功")
    //     })
    //     console.log(p)
    //     return p;
    // }
    // async().then(data=>{
    //     console.log(data)
    // })




    

    function runAsync1(){
        var p = new Promise(function(resolve, reject){
            //做一些异步操作
            setTimeout(function(){
                console.log('1执行完成');
                resolve('数据1');
            }, 300);
        });
        return p;            
    }
    function runAsync2(){
        var p = new Promise(function(resolve, reject){
            //做一些异步操作
            setTimeout(function(){
                console.log('2执行完成');
                resolve('数据2');
            }, 600);
        });
        return p;            
    }
    function runAsync3(){
        var p = new Promise(function(resolve, reject){
            //做一些异步操作
            setTimeout(function(){
                console.log('3执行完成');
                resolve('数据3');
            }, 900);
        });
        return p;            
    }

    // runAsync1()
    // .then(data=>{
    //     console.log(data);
    //     return runAsync2()
    // })
    // .then(data=>{
    //     console.log(data);
    //     return runAsync3()
    // })
    // .then(data=>{
    //     console.log(data)
    // })



    // function getNumber(){
    //     return new Promise((resolve,reject)=>{
    //         let num = Math.ceil(Math.random()*10)
    //         if(num<5){
    //             resolve(num)
    //         }else{
    //             reject("数字大于5")
    //         }
    //     })
    // }
    //then方法
    // getNumber().then(
    //     data=>{
    //         console.log(data)
    //     },
    //     reason=>{
    //         console.log(reason)
    //     }
    // )
    //catch方法
    // getNumber().then(
    //     data=>{
    //         console.log(data)
    //     }
    // ).catch(
    //     reason=>{
    //         console.log(reason)
    //     }
    // )

    //all方法 「谁跑的慢，以谁为准执行回调」
    // Promise.all([runAsync1(),runAsync2(),runAsync3()])
    // .then(
    //     results=>{
    //         console.log(results)
    //     }
    // )
    //race 「谁跑的快，以谁为准执行回调」
    // Promise.race([runAsync1(),runAsync2(),runAsync3()])
    // .then(
    //     results=>{
    //         console.log(results)
    //     }
    // )

    function requestImg(){
        return new Promise((resolve,reject)=>{
            var Img= new Image()
            document.querySelector("#box").appendChild(Img)
            Img.src="http://wanghg.top/images/img5.jpg"
            Img.onload=function(){
                resolve(Img)
            }
        })
    }
    function requestImg2(){
        return new Promise(function(resolve,reject){
            setTimeout(function(){
                reject("请求图片超时")
            },100)
        })           
    }

    Promise.race([requestImg(),requestImg2()])
    .then(data=>{
        console.log(data)
    }).catch(reason=>{
        console.log(reason)
    })
</script>
</html>